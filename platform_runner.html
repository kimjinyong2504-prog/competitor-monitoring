<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”Œë«í¼ ëŸ¬ë„ˆ ê²Œì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .game-container {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 10px;
            margin: 5px;
            min-width: 120px;
        }

        .info-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            position: relative;
        }

        #gameCanvas {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F6FF 50%, #98FB98 100%);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            display: block;
        }

        .controls {
            margin: 20px 0;
        }

        button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            color: white;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .game-status {
            margin: 15px 0;
            font-size: 1.3em;
            font-weight: bold;
            min-height: 30px;
        }

        .game-status.game-over {
            color: #ff6b6b;
            animation: pulse 1s infinite;
        }

        .game-status.playing {
            color: #51cf66;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .instructions {
            margin-top: 20px;
            font-size: 0.9em;
            opacity: 0.9;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .mobile-controls {
            display: none;
            margin-top: 20px;
            gap: 10px;
            justify-content: center;
        }

        .mobile-controls button {
            width: 80px;
            height: 80px;
            font-size: 2em;
            border-radius: 50%;
        }

        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸƒ í”Œë«í¼ ëŸ¬ë„ˆ</h1>

        <div class="game-info">
            <div class="info-item">
                <div class="info-label">ê±°ë¦¬</div>
                <div class="info-value" id="distance">0m</div>
            </div>
            <div class="info-item">
                <div class="info-label">ì ìˆ˜</div>
                <div class="info-value" id="score">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">ìµœê³  ê¸°ë¡</div>
                <div class="info-value" id="highScore">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">ì†ë„</div>
                <div class="info-value" id="speed">1x</div>
            </div>
            <div class="info-item">
                <div class="info-label">ì í”„</div>
                <div class="info-value" id="jumpCount">2/2</div>
            </div>
        </div>

        <div class="game-status" id="gameStatus">ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” í™”ì‚´í‘œ ìœ„ë¥¼ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”!</div>

        <div class="canvas-container">
            <canvas id="gameCanvas" width="800" height="400"></canvas>
        </div>

        <div class="controls">
            <button onclick="startGame()" id="startButton">ê²Œì„ ì‹œì‘</button>
            <button onclick="pauseGame()" id="pauseButton">ì¼ì‹œì •ì§€</button>
            <button onclick="resetGame()" id="resetButton">ë‹¤ì‹œ ì‹œì‘</button>
        </div>

        <div style="margin: 20px 0; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px;">
            <p style="margin-bottom: 10px; font-size: 0.9em;"><strong>ê³ ì–‘ì´ ì´ë¯¸ì§€ ì„¤ì •:</strong></p>
            <p style="font-size: 0.85em; opacity: 0.9; margin-bottom: 15px; line-height: 1.6;">
                <strong>ğŸ’¡ íŒ:</strong> ë³´ì—¬ì£¼ì‹  ê³ ì–‘ì´ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ë°°ê²½ì´ ìë™ìœ¼ë¡œ ì œê±°ë˜ì–´ ê²Œì„ ìºë¦­í„°ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤!<br>
                ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ê±°ë‚˜ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.
            </p>
            <div id="dropZone" style="border: 2px dashed rgba(255, 255, 255, 0.5); padding: 20px; border-radius: 10px; 
                text-align: center; margin-bottom: 10px; cursor: pointer; transition: all 0.3s;">
                <p style="font-size: 1.1em; margin-bottom: 5px;">ğŸ“ ì´ë¯¸ì§€ë¥¼ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­</p>
                <p style="font-size: 0.9em; opacity: 0.8;">ë˜ëŠ” í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</p>
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
            </div>
            <div style="text-align: center;">
                <input type="text" id="imageUrlInput" placeholder="ë˜ëŠ” ì´ë¯¸ì§€ URL ì…ë ¥" 
                       style="width: 300px; padding: 8px; border-radius: 5px; border: 2px solid rgba(255, 255, 255, 0.3); 
                              background: rgba(255, 255, 255, 0.2); color: white; margin-right: 10px;">
                <button onclick="loadImageFromUrl()" style="padding: 8px 15px;">ì´ë¯¸ì§€ ë¡œë“œ</button>
            </div>
            <div id="imageStatus" style="text-align: center; margin-top: 10px; font-size: 0.9em; font-weight: bold; min-height: 20px;"></div>
            <p style="font-size: 0.8em; opacity: 0.7; margin-top: 10px; text-align: center;">
                ğŸ’¾ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì–´ ë‹¤ìŒì— ê²Œì„ì„ ì—´ ë•Œ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤!
            </p>
        </div>

        <div class="mobile-controls">
            <button onclick="jump()" id="jumpButton">â†‘<br>ì í”„</button>
        </div>

        <div class="instructions">
            <p><strong>ê²Œì„ ë°©ë²•:</strong></p>
            <p>ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” â†‘ í‚¤ë¥¼ ëˆŒëŸ¬ ì í”„í•˜ê³  ì¥ì• ë¬¼ì„ í”¼í•˜ì„¸ìš”!</p>
            <p>ê³µì¤‘ì—ì„œ í•œ ë²ˆ ë” ì í”„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! (ë‘ ë²ˆ ë›°ê¸°)</p>
            <p>í”Œë«í¼ì—ì„œ ë–¨ì–´ì§€ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”!</p>
            <p>ë©€ë¦¬ ë‹¬ë¦´ìˆ˜ë¡ ì†ë„ê°€ ë¹¨ë¼ì§€ê³  ì ìˆ˜ê°€ ë†’ì•„ì§‘ë‹ˆë‹¤</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // ê²Œì„ ë³€ìˆ˜
        let gameRunning = false;
        let gamePaused = false;
        let gameSpeed = 5;
        let distance = 0;
        let gameLoopId = null; // ê²Œì„ ë£¨í”„ ID ì¶”ì 
        let score = 0;
        let highScore = localStorage.getItem('runnerHighScore') ? parseInt(localStorage.getItem('runnerHighScore')) : 0;
        
        // í‚¤ ì…ë ¥ ìƒíƒœ ì¶”ì 
        let keysPressed = {
            space: false,
            up: false
        };

        // í”Œë ˆì´ì–´ ì„¤ì •
        const player = {
            x: 100,
            y: 300,
            width: 60,  // ë” í¬ê²Œ
            height: 70, // ë” í¬ê²Œ
            velocityY: 0,
            isJumping: false,
            groundY: 300,
            jumpPower: -18,  // ì í”„ íŒŒì›Œ ì¦ê°€
            gravity: 0.7,     // ì¤‘ë ¥ ì•½ê°„ ê°ì†Œí•˜ì—¬ ë” ì˜¤ë˜ ê³µì¤‘ì— ë¨¸ë¬´ë¦„
            maxJumpHeight: 100,  // ìµœëŒ€ ì í”„ ë†’ì´ (í”Œë«í¼ ê¸°ì¤€)
            jumpCount: 0,      // í˜„ì¬ ì í”„ íšŸìˆ˜
            maxJumps: 2        // ìµœëŒ€ ì í”„ íšŸìˆ˜ (ë‘ ë²ˆ ë›°ê¸°)
        };
        
        // ê³ ì–‘ì´ ì´ë¯¸ì§€
        const catImage = new Image();
        let imageLoaded = false;
        
        // ê¸°ë³¸ ì´ë¯¸ì§€ ì‹œë„ (ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ë®ì–´ì”€)
        // ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ ë„íŠ¸ ì•„íŠ¸ ì‚¬ìš©

        // í”Œë«í¼ë“¤
        let platforms = [];
        // ì¥ì• ë¬¼ë“¤
        let obstacles = [];
        // ë°°ê²½ ìš”ì†Œë“¤
        let clouds = [];
        let groundOffset = 0;
        
        // ì í”„ íŒŒí‹°í´ íš¨ê³¼
        let particles = [];
        
        // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ (ì í”„ ì†Œë¦¬ìš©)
        let audioContext = null;

        // UI ìš”ì†Œ
        const distanceDisplay = document.getElementById('distance');
        const scoreDisplay = document.getElementById('score');
        const highScoreDisplay = document.getElementById('highScore');
        const speedDisplay = document.getElementById('speed');
        const jumpCountDisplay = document.getElementById('jumpCount');
        const gameStatus = document.getElementById('gameStatus');
        const startButton = document.getElementById('startButton');
        const pauseButton = document.getElementById('pauseButton');

        highScoreDisplay.textContent = highScore;

        // ì´ˆê¸° í”Œë«í¼ ìƒì„±
        function initializePlatforms() {
            platforms = [];
            // ì‹œì‘ í”Œë«í¼
            for (let i = 0; i < 10; i++) {
                platforms.push({
                    x: i * 100,
                    y: 350,
                    width: 100,
                    height: 50
                });
            }
        }

        // ì´ˆê¸° êµ¬ë¦„ ìƒì„±
        function initializeClouds() {
            clouds = [];
            for (let i = 0; i < 5; i++) {
                clouds.push({
                    x: Math.random() * canvas.width,
                    y: 50 + Math.random() * 100,
                    width: 60 + Math.random() * 40,
                    height: 30 + Math.random() * 20,
                    speed: 0.5 + Math.random() * 0.5
                });
            }
        }

        // ìƒˆ ì¥ì• ë¬¼ ìƒì„±
        function spawnObstacle() {
            const platform = platforms[platforms.length - 1];
            const obstacleHeight = 25;  // ì¥ì• ë¬¼ ë†’ì´ ê°ì†Œ
            obstacles.push({
                x: platform.x + platform.width,
                y: platform.y - obstacleHeight,  // í”Œë«í¼ ìœ„ì— ìœ„ì¹˜ (ë” ë‚®ê²Œ)
                width: 30,
                height: obstacleHeight,
                type: Math.random() > 0.5 ? 'spike' : 'box'
            });
        }

        // ìƒˆ í”Œë«í¼ ìƒì„±
        function spawnPlatform() {
            const lastPlatform = platforms[platforms.length - 1];
            const gap = 150 + Math.random() * 100;
            const heightVariation = Math.random() > 0.7 ? -50 + Math.random() * 50 : 0;
            
            platforms.push({
                x: lastPlatform.x + lastPlatform.width + gap,
                y: Math.max(200, Math.min(350, 350 + heightVariation)),
                width: 100 + Math.random() * 50,
                height: 50
            });
        }

        // ê·¸ë¦¬ê¸° í•¨ìˆ˜ë“¤
        function drawBackground() {
            // í•˜ëŠ˜
            const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            skyGradient.addColorStop(0, '#87CEEB');
            skyGradient.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // êµ¬ë¦„
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            for (let cloud of clouds) {
                ctx.beginPath();
                ctx.arc(cloud.x, cloud.y, cloud.width / 3, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width / 3, cloud.y, cloud.width / 2, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width * 2/3, cloud.y, cloud.width / 3, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function drawPlayer() {
            // ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìœ¼ë©´ ì´ë¯¸ì§€ ì‚¬ìš©
            if (imageLoaded && catImage.complete) {
                ctx.save();
                
                // ì í”„ ì¤‘ì¼ ë•Œ ì•½ê°„ì˜ íšŒì „ íš¨ê³¼
                if (player.isJumping && player.velocityY < 0) {
                    const centerX = player.x + player.width / 2;
                    const centerY = player.y + player.height / 2;
                    ctx.translate(centerX, centerY);
                    ctx.rotate(-0.1);
                    ctx.translate(-centerX, -centerY);
                }
                
                // ë°°ê²½ ì œê±°ëœ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                ctx.globalCompositeOperation = 'source-over';
                ctx.drawImage(catImage, player.x, player.y, player.width, player.height);
                
                ctx.restore();
                
                // ì í”„ ì¤‘ì¼ ë•Œ ë°”ëŒ ì„  íš¨ê³¼
                if (player.isJumping && player.velocityY < 0) {
                    ctx.strokeStyle = 'rgba(200, 200, 200, 0.5)';
                    ctx.lineWidth = 2;
                    for (let i = 0; i < 3; i++) {
                        ctx.beginPath();
                        ctx.moveTo(player.x - 5 - i * 3, player.y + 10 + i * 5);
                        ctx.lineTo(player.x - 10 - i * 3, player.y + 15 + i * 5);
                        ctx.stroke();
                    }
                }
            } else {
                // ê¸°ë³¸ê°’: ì´ë¯¸ì§€ ì„¤ëª… ê¸°ë°˜ ì •í™•í•œ ê³ ì–‘ì´ ë„íŠ¸ ì•„íŠ¸
                drawDefaultCat();
            }
        }
        
        // ê¸°ë³¸ ê³ ì–‘ì´ ê·¸ë¦¬ê¸° (Canvas pathë¡œ ë¶€ë“œëŸ½ê³  ëª…í™•í•˜ê²Œ)
        function drawDefaultCat() {
            ctx.save();
            const x = player.x;
            const y = player.y;
            const w = player.width;
            const h = player.height;
            
            const cream = '#FFF8E7';
            const ginger = '#CD853F';
            const black = '#000000';
            const outline = '#2C2C2C';
            const pink = '#FFB6C1';
            
            // ì „ì²´ ê³ ì–‘ì´ë¥¼ ë” í¬ê³  ëª…í™•í•˜ê²Œ ê·¸ë¦¬ê¸°
            const scale = Math.min(w / 60, h / 70);
            const offsetX = x + (w - 60 * scale) / 2;
            const offsetY = y + (h - 70 * scale) / 2;
            
            // ëª¸í†µ (í¬ë¦¼ìƒ‰, ë‘¥ê·¼ í˜•íƒœ) - íƒ€ì›í˜•
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 30 * scale, offsetY + 45 * scale);
            ctx.scale(1, 0.83); // íƒ€ì›í˜• ë§Œë“¤ê¸°
            ctx.arc(0, 0, 18 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.lineWidth = 2 * scale;
            ctx.stroke();
            
            // ë“± ë’¤ìª½ ì§„ì € íŒ¨ì¹˜
            ctx.fillStyle = ginger;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 40 * scale, offsetY + 40 * scale);
            ctx.scale(1, 0.75);
            ctx.arc(0, 0, 8 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ë¨¸ë¦¬ (í¬ë¦¼ìƒ‰, ë‘¥ê·¼ í˜•íƒœ)
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 30 * scale, offsetY + 20 * scale);
            ctx.scale(1, 0.9);
            ctx.arc(0, 0, 20 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ë¨¸ë¦¬ ìœ„ ì§„ì € íŒ¨ì¹˜ (í° íŒ¨ì¹˜)
            ctx.fillStyle = ginger;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 30 * scale, offsetY + 8 * scale);
            ctx.scale(1, 0.55);
            ctx.arc(0, 0, 18 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ì™¼ìª½ ê·€ (ë’¤ì— ìˆìŒ, ì‘ê²Œ)
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.moveTo(offsetX + 12 * scale, offsetY + 12 * scale);
            ctx.lineTo(offsetX + 8 * scale, offsetY + 5 * scale);
            ctx.lineTo(offsetX + 16 * scale, offsetY + 8 * scale);
            ctx.closePath();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ì˜¤ë¥¸ìª½ ê·€ (ì§„ì € íŒ¨ì¹˜, ì•ˆìª½ ë¶„í™) - ë¾°ì¡±í•˜ê²Œ
            ctx.fillStyle = ginger;
            ctx.beginPath();
            ctx.moveTo(offsetX + 48 * scale, offsetY + 12 * scale);
            ctx.lineTo(offsetX + 55 * scale, offsetY + 3 * scale);
            ctx.lineTo(offsetX + 52 * scale, offsetY + 8 * scale);
            ctx.closePath();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ê·€ ì•ˆìª½ ë¶„í™
            ctx.fillStyle = pink;
            ctx.beginPath();
            ctx.moveTo(offsetX + 50 * scale, offsetY + 10 * scale);
            ctx.lineTo(offsetX + 53 * scale, offsetY + 5 * scale);
            ctx.lineTo(offsetX + 51 * scale, offsetY + 8 * scale);
            ctx.closePath();
            ctx.fill();
            
            // ëˆˆ (ì‘ì€ ë‘¥ê·¼ ê²€ì€ ì  - ëª…í™•í•˜ê²Œ)
            ctx.fillStyle = black;
            ctx.beginPath();
            ctx.arc(offsetX + 22 * scale, offsetY + 22 * scale, 2.5 * scale, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(offsetX + 38 * scale, offsetY + 22 * scale, 2.5 * scale, 0, Math.PI * 2);
            ctx.fill();
            
            // ì… (ë¬¼ê²°ì„  ë¯¸ì†Œ - ìœ„ë¡œ ì˜¬ë¼ê°„ í˜•íƒœ)
            ctx.strokeStyle = outline;
            ctx.lineWidth = 1.5 * scale;
            ctx.beginPath();
            ctx.moveTo(offsetX + 20 * scale, offsetY + 30 * scale);
            ctx.quadraticCurveTo(offsetX + 25 * scale, offsetY + 28 * scale, offsetX + 30 * scale, offsetY + 30 * scale);
            ctx.quadraticCurveTo(offsetX + 35 * scale, offsetY + 28 * scale, offsetX + 40 * scale, offsetY + 30 * scale);
            ctx.stroke();
            
            // ëª©ê³¼ ê°€ìŠ´ (í¬ë¦¼ìƒ‰)
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 30 * scale, offsetY + 35 * scale);
            ctx.scale(1, 0.67);
            ctx.arc(0, 0, 12 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ì•ë‹¤ë¦¬ (ì§§ê³  ë­‰íˆ­í•œ)
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 20 * scale, offsetY + 56 * scale);
            ctx.scale(1, 1.2);
            ctx.arc(0, 0, 5 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ë’·ë‹¤ë¦¬ (ì§§ê³  ë­‰íˆ­í•œ)
            ctx.fillStyle = cream;
            ctx.beginPath();
            ctx.save();
            ctx.translate(offsetX + 40 * scale, offsetY + 58 * scale);
            ctx.scale(1, 1.2);
            ctx.arc(0, 0, 5 * scale, 0, Math.PI * 2);
            ctx.restore();
            ctx.fill();
            ctx.strokeStyle = outline;
            ctx.stroke();
            
            // ê¼¬ë¦¬ (ì§„ì €ìƒ‰, ëì€ í¬ë¦¼ìƒ‰, ìœ„ë¡œ ë¶€ë“œëŸ½ê²Œ ë§ë¦¼)
            ctx.strokeStyle = outline;
            ctx.lineWidth = 2 * scale;
            ctx.fillStyle = ginger;
            if (player.isJumping && player.velocityY < 0) {
                // ì í”„ ì‹œ ê¼¬ë¦¬ í¼ì¹¨
                ctx.beginPath();
                ctx.moveTo(offsetX + 45 * scale, offsetY + 40 * scale);
                ctx.quadraticCurveTo(offsetX + 50 * scale, offsetY + 25 * scale, offsetX + 55 * scale, offsetY + 15 * scale);
                ctx.lineWidth = 6 * scale;
                ctx.stroke();
                // ê¼¬ë¦¬ ë í¬ë¦¼ìƒ‰
                ctx.fillStyle = cream;
                ctx.beginPath();
                ctx.arc(offsetX + 55 * scale, offsetY + 15 * scale, 3 * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
            } else {
                // í‰ì†Œ ê¼¬ë¦¬ (ìœ„ë¡œ ë¶€ë“œëŸ½ê²Œ ë§ë¦¼)
                ctx.beginPath();
                ctx.moveTo(offsetX + 45 * scale, offsetY + 42 * scale);
                ctx.quadraticCurveTo(offsetX + 50 * scale, offsetY + 30 * scale, offsetX + 52 * scale, offsetY + 20 * scale);
                ctx.quadraticCurveTo(offsetX + 54 * scale, offsetY + 12 * scale, offsetX + 50 * scale, offsetY + 8 * scale);
                ctx.lineWidth = 6 * scale;
                ctx.stroke();
                // ê¼¬ë¦¬ ë í¬ë¦¼ìƒ‰
                ctx.fillStyle = cream;
                ctx.beginPath();
                ctx.arc(offsetX + 50 * scale, offsetY + 8 * scale, 3 * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
            }
            
            ctx.restore();
        }
        
        // ë°°ê²½ ì œê±° í•¨ìˆ˜
        function removeBackground(img) {
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = img.width;
            tempCanvas.height = img.height;
            
            tempCtx.drawImage(img, 0, 0);
            const imageData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);
            const data = imageData.data;
            
            // ê°€ì¥ìë¦¬ í”½ì…€ ìƒ‰ìƒì„ ë°°ê²½ìƒ‰ìœ¼ë¡œ ì¶”ì •
            const edgeColors = [];
            const sampleSize = 10;
            for (let i = 0; i < sampleSize; i++) {
                // ìƒë‹¨ ê°€ì¥ìë¦¬
                const topIdx = (i * 4) + (0 * tempCanvas.width * 4);
                edgeColors.push([data[topIdx], data[topIdx + 1], data[topIdx + 2]]);
                // í•˜ë‹¨ ê°€ì¥ìë¦¬
                const bottomIdx = (i * 4) + ((tempCanvas.height - 1) * tempCanvas.width * 4);
                edgeColors.push([data[bottomIdx], data[bottomIdx + 1], data[bottomIdx + 2]]);
            }
            
            // ë°°ê²½ìƒ‰ ê³„ì‚° (í‰ê· )
            let bgR = 0, bgG = 0, bgB = 0;
            for (let color of edgeColors) {
                bgR += color[0];
                bgG += color[1];
                bgB += color[2];
            }
            bgR = Math.floor(bgR / edgeColors.length);
            bgG = Math.floor(bgG / edgeColors.length);
            bgB = Math.floor(bgB / edgeColors.length);
            
            // ë°°ê²½ìƒ‰ê³¼ ìœ ì‚¬í•œ í”½ì…€ì„ íˆ¬ëª…í•˜ê²Œ
            const threshold = 30; // ìƒ‰ìƒ ì°¨ì´ ì„ê³„ê°’
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                const diff = Math.abs(r - bgR) + Math.abs(g - bgG) + Math.abs(b - bgB);
                if (diff < threshold) {
                    data[i + 3] = 0; // ì•ŒíŒŒê°’ì„ 0ìœ¼ë¡œ (íˆ¬ëª…)
                }
            }
            
            tempCtx.putImageData(imageData, 0, 0);
            
            // ìƒˆ ì´ë¯¸ì§€ ìƒì„±
            const newImg = new Image();
            newImg.src = tempCanvas.toDataURL();
            return newImg;
        }
        
        // ì´ë¯¸ì§€ ë¡œë“œ í•¨ìˆ˜
        function loadImageFromFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // ë°°ê²½ ì œê±°
                    const processedImg = removeBackground(img);
                    processedImg.onload = function() {
                        catImage.src = processedImg.src;
                        // localStorageì— ì €ì¥ (ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©)
                        try {
                            localStorage.setItem('catImageData', processedImg.src);
                            console.log('ì´ë¯¸ì§€ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                        } catch (err) {
                            console.warn('ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨:', err);
                        }
                    };
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function loadImageFromUrl() {
            const url = document.getElementById('imageUrlInput').value;
            if (url) {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = function() {
                    // ë°°ê²½ ì œê±°
                    const processedImg = removeBackground(img);
                    processedImg.onload = function() {
                        catImage.src = processedImg.src;
                        // localStorageì— ì €ì¥ (ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©)
                        try {
                            localStorage.setItem('catImageData', processedImg.src);
                            console.log('ì´ë¯¸ì§€ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                        } catch (err) {
                            console.warn('ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨:', err);
                        }
                    };
                };
                img.onerror = function() {
                    alert('ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. CORS ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                };
                img.src = url;
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì´ë¯¸ì§€ ìë™ ë¡œë“œ
        function loadSavedImage() {
            try {
                const savedImageData = localStorage.getItem('catImageData');
                if (savedImageData) {
                    catImage.src = savedImageData;
                    console.log('ì €ì¥ëœ ì´ë¯¸ì§€ê°€ ìë™ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                    // ì €ì¥ëœ ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŒì„ í‘œì‹œ
                    setTimeout(() => {
                        const statusDiv = document.getElementById('imageStatus');
                        if (statusDiv && imageLoaded) {
                            statusDiv.textContent = 'âœ… ì €ì¥ëœ ê³ ì–‘ì´ ì´ë¯¸ì§€ê°€ ìë™ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!';
                            statusDiv.style.color = '#4ade80';
                            setTimeout(() => {
                                statusDiv.textContent = '';
                            }, 3000);
                        }
                    }, 100);
                }
            } catch (err) {
                console.warn('ì €ì¥ëœ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', err);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', function() {
            loadSavedImage();
        });
        
        // ì´ë¯¸ì§€ ë¡œë“œ ì´ë²¤íŠ¸
        catImage.onload = function() {
            imageLoaded = true;
            // ì´ë¯¸ì§€ í¬ê¸°ì— ë§ì¶° í”Œë ˆì´ì–´ í¬ê¸° ì¡°ì • (ë¹„ìœ¨ ìœ ì§€)
            const aspectRatio = catImage.width / catImage.height;
            player.height = 50;
            player.width = 50 * aspectRatio;
            
            // ì €ì¥ëœ ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŒì„ í‘œì‹œ
            const statusDiv = document.getElementById('imageStatus');
            if (statusDiv) {
                statusDiv.textContent = 'âœ… ê³ ì–‘ì´ ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!';
                statusDiv.style.color = '#4ade80';
                setTimeout(() => {
                    statusDiv.textContent = '';
                }, 3000);
            }
            
            drawGame();
        };
        
        catImage.onerror = function() {
            imageLoaded = false;
            alert('ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. URLì„ í™•ì¸í•˜ê±°ë‚˜ íŒŒì¼ì„ ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.');
        };
        
        // íŒŒì¼ ì…ë ¥ ì´ë²¤íŠ¸
        document.getElementById('imageInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                loadImageFromFile(file);
            }
        });
        
        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
        const dropZone = document.getElementById('dropZone');
        const imageInput = document.getElementById('imageInput');
        
        dropZone.addEventListener('click', function() {
            imageInput.click();
        });
        
        dropZone.addEventListener('dragover', function(e) {
            e.preventDefault();
            dropZone.style.borderColor = 'rgba(255, 255, 255, 0.8)';
            dropZone.style.background = 'rgba(255, 255, 255, 0.1)';
        });
        
        dropZone.addEventListener('dragleave', function(e) {
            e.preventDefault();
            dropZone.style.borderColor = 'rgba(255, 255, 255, 0.5)';
            dropZone.style.background = 'transparent';
        });
        
        dropZone.addEventListener('drop', function(e) {
            e.preventDefault();
            dropZone.style.borderColor = 'rgba(255, 255, 255, 0.5)';
            dropZone.style.background = 'transparent';
            
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                loadImageFromFile(file);
            }
        });

        function drawPlatforms() {
            ctx.fillStyle = '#8B4513';
            for (let platform of platforms) {
                ctx.fillRect(platform.x - groundOffset, platform.y, platform.width, platform.height);
                
                // í”Œë«í¼ í…Œë‘ë¦¬
                ctx.strokeStyle = '#654321';
                ctx.lineWidth = 2;
                ctx.strokeRect(platform.x - groundOffset, platform.y, platform.width, platform.height);
                
                // í”Œë«í¼ í…ìŠ¤ì²˜
                ctx.fillStyle = '#A0522D';
                for (let i = 0; i < platform.width; i += 20) {
                    ctx.fillRect(platform.x - groundOffset + i, platform.y, 2, platform.height);
                }
                ctx.fillStyle = '#8B4513';
            }
        }

        function drawObstacles() {
            for (let obstacle of obstacles) {
                if (obstacle.type === 'spike') {
                    // ê°€ì‹œ
                    ctx.fillStyle = '#8B0000';
                    ctx.beginPath();
                    ctx.moveTo(obstacle.x - groundOffset, obstacle.y + obstacle.height);
                    ctx.lineTo(obstacle.x - groundOffset + obstacle.width / 2, obstacle.y);
                    ctx.lineTo(obstacle.x - groundOffset + obstacle.width, obstacle.y + obstacle.height);
                    ctx.closePath();
                    ctx.fill();
                } else {
                    // ë°•ìŠ¤
                    ctx.fillStyle = '#ff4757';
                    ctx.fillRect(obstacle.x - groundOffset, obstacle.y, obstacle.width, obstacle.height);
                    ctx.strokeStyle = '#c44536';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(obstacle.x - groundOffset, obstacle.y, obstacle.width, obstacle.height);
                }
            }
        }

        // ì¶©ëŒ ê°ì§€
        function checkCollisions() {
            // í”Œë«í¼ ì¶©ëŒ
            let onPlatform = false;
            for (let platform of platforms) {
                const platformScreenX = platform.x - groundOffset;
                // í”Œë«í¼ì˜ X ë²”ìœ„ ë‚´ì— ìˆê³ 
                if (player.x + player.width > platformScreenX &&
                    player.x < platformScreenX + platform.width) {
                    
                    // í”Œë«í¼ ìœ„ì— ì°©ì§€í•˜ëŠ” ê²½ìš° (ë–¨ì–´ì§€ëŠ” ì¤‘ì´ê³  í”Œë«í¼ ìœ„)
                    if (player.y + player.height >= platform.y - 5 &&
                        player.y + player.height <= platform.y + 20 &&
                        player.velocityY >= 0) {
                        player.y = platform.y - player.height;
                        player.velocityY = 0;
                        player.isJumping = false;
                        player.jumpCount = 0; // ì í”„ ì¹´ìš´í„° ë¦¬ì…‹
                        onPlatform = true;
                        player.groundY = platform.y - player.height;
                        break;
                    }
                    
                    // ì´ë¯¸ í”Œë«í¼ ìœ„ì— ì„œìˆëŠ” ê²½ìš° (ì•½ê°„ì˜ ì—¬ìœ )
                    if (player.y + player.height >= platform.y - 8 &&
                        player.y + player.height <= platform.y + 8 &&
                        (player.velocityY === 0 || Math.abs(player.velocityY) < 2)) {
                        player.y = platform.y - player.height;
                        player.velocityY = 0;
                        player.isJumping = false;
                        player.jumpCount = 0; // ì í”„ ì¹´ìš´í„° ë¦¬ì…‹
                        onPlatform = true;
                        player.groundY = platform.y - player.height;
                        break;
                    }
                }
            }

            // í”Œë«í¼ ìœ„ì— ìˆì§€ ì•Šìœ¼ë©´ ì¤‘ë ¥ ì ìš©
            if (!onPlatform) {
                player.velocityY += player.gravity;
                // ë–¨ì–´ì§€ëŠ” ì¤‘ì´ë©´ ì í”„ ìƒíƒœ ìœ ì§€
                if (player.velocityY > 0) {
                    player.isJumping = true;
                }
            } else {
                // í”Œë«í¼ ìœ„ì— ìˆìœ¼ë©´ velocityYë¥¼ í™•ì‹¤íˆ 0ìœ¼ë¡œ ìœ ì§€
                player.velocityY = 0;
                player.isJumping = false;
            }

            // ì¥ì• ë¬¼ ì¶©ëŒ (í”Œë ˆì´ì–´ê°€ ì¥ì• ë¬¼ ìœ„ë¡œ ì™„ì „íˆ ë„˜ì–´ê°€ë©´ ì¶©ëŒ ì•„ë‹˜)
            for (let obstacle of obstacles) {
                const obstacleScreenX = obstacle.x - groundOffset;
                
                // Xì¶•ì—ì„œ ê²¹ì¹˜ëŠ”ì§€ í™•ì¸
                if (player.x < obstacleScreenX + obstacle.width &&
                    player.x + player.width > obstacleScreenX) {
                    
                    const playerTop = player.y;
                    const playerBottom = player.y + player.height;
                    const obstacleTop = obstacle.y;
                    const obstacleBottom = obstacle.y + obstacle.height;
                    
                    // í”Œë ˆì´ì–´ê°€ ì¥ì• ë¬¼ ìœ„ë¡œ ì™„ì „íˆ ë„˜ì–´ê°„ ê²½ìš° (í”Œë ˆì´ì–´ ë°œì´ ì¥ì• ë¬¼ ìœ„ì— ìˆìŒ)
                    if (playerBottom <= obstacleTop + 3 && player.velocityY >= 0) {
                        // ì¥ì• ë¬¼ ìœ„ì— ì°©ì§€í•œ ê²ƒìœ¼ë¡œ ì²˜ë¦¬ (ì¶©ëŒ ì•„ë‹˜)
                        continue;
                    }
                    
                    // í”Œë ˆì´ì–´ê°€ ì¥ì• ë¬¼ê³¼ ê²¹ì¹˜ëŠ” ê²½ìš° (ìœ„ë¡œ ë„˜ì–´ê°€ì§€ ëª»í•¨)
                    if (playerTop < obstacleBottom && playerBottom > obstacleTop) {
                        gameOver();
                        return;
                    }
                }
            }

            // í™”ë©´ ë°–ìœ¼ë¡œ ë–¨ì–´ì§ (ì•½ê°„ì˜ ì—¬ìœ ë¥¼ ë‘ )
            if (player.y > canvas.height + 50) {
                gameOver();
                return;
            }
        }

        // ê²Œì„ ì—…ë°ì´íŠ¸
        function updateGame() {
            if (!gameRunning || gamePaused) return;

            // í”Œë ˆì´ì–´ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (ì¤‘ë ¥ì€ checkCollisionsì—ì„œ ì²˜ë¦¬)
            player.y += player.velocityY;

            // ì†ë„ ì¦ê°€
            groundOffset += gameSpeed;
            distance += gameSpeed * 0.1;
            
            // ê²Œì„ ì†ë„ ì ì§„ì  ì¦ê°€
            gameSpeed = 5 + Math.floor(distance / 500) * 0.5;
            score = Math.floor(distance * 10);

            // í”Œë«í¼ ìƒì„±
            const lastPlatform = platforms[platforms.length - 1];
            if (lastPlatform.x - groundOffset < canvas.width + 200) {
                spawnPlatform();
                if (Math.random() > 0.6) {
                    spawnObstacle();
                }
            }

            // ì˜¤ë˜ëœ í”Œë«í¼ ì œê±°
            platforms = platforms.filter(p => p.x - groundOffset + p.width > -100);
            obstacles = obstacles.filter(o => o.x - groundOffset + o.width > -100);

            // êµ¬ë¦„ ì´ë™
            for (let cloud of clouds) {
                cloud.x -= cloud.speed;
                if (cloud.x + cloud.width < 0) {
                    cloud.x = canvas.width;
                    cloud.y = 50 + Math.random() * 100;
                }
            }
            
            // íŒŒí‹°í´ ì—…ë°ì´íŠ¸
            updateParticles();

            // UI ì—…ë°ì´íŠ¸
            distanceDisplay.textContent = Math.floor(distance) + 'm';
            scoreDisplay.textContent = score;
            speedDisplay.textContent = (gameSpeed / 5).toFixed(1) + 'x';
            jumpCountDisplay.textContent = (player.maxJumps - player.jumpCount) + '/' + player.maxJumps;

            checkCollisions();
        }
        
        // íŒŒí‹°í´ ì—…ë°ì´íŠ¸
        function updateParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.2; // ì¤‘ë ¥
                p.life--;
                
                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function drawGame() {
            drawBackground();
            drawPlatforms();
            drawObstacles();
            drawParticles();
            drawPlayer();
        }
        
        // íŒŒí‹°í´ ê·¸ë¦¬ê¸°
        function drawParticles() {
            for (let p of particles) {
                const alpha = p.life / p.maxLife;
                ctx.fillStyle = `rgba(139, 69, 19, ${alpha * 0.8})`; // ê°ˆìƒ‰ ë¨¼ì§€
                ctx.fillRect(p.x - groundOffset, p.y, p.size, p.size);
            }
        }

        function gameOver() {
            gameRunning = false;
            stopGameLoop(); // ê²Œì„ ë£¨í”„ ì¤‘ì§€
            gameStatus.textContent = `ê²Œì„ ì˜¤ë²„! ìµœì¢… ê±°ë¦¬: ${Math.floor(distance)}m, ì ìˆ˜: ${score}`;
            gameStatus.className = 'game-status game-over';
            startButton.disabled = false;
            pauseButton.disabled = true;

            if (score > highScore) {
                highScore = score;
                highScoreDisplay.textContent = highScore;
                localStorage.setItem('runnerHighScore', highScore.toString());
            }
        }

        function gameLoop() {
            if (!gameRunning || gamePaused) {
                gameLoopId = null;
                return;
            }

            updateGame();
            drawGame();

            gameLoopId = requestAnimationFrame(gameLoop);
        }
        
        // ê²Œì„ ë£¨í”„ ì¤‘ì§€ í•¨ìˆ˜
        function stopGameLoop() {
            if (gameLoopId !== null) {
                cancelAnimationFrame(gameLoopId);
                gameLoopId = null;
            }
        }

        function jump() {
            if (!gameRunning || gamePaused) return;

            // ìµœëŒ€ ì í”„ íšŸìˆ˜ í™•ì¸
            if (player.jumpCount >= player.maxJumps) return;

            // ì²« ë²ˆì§¸ ì í”„: í”Œë«í¼ ìœ„ì— ìˆì–´ì•¼ í•¨
            if (player.jumpCount === 0) {
                // í”Œë«í¼ ìœ„ì— ìˆëŠ”ì§€ í™•ì¸
                let onPlatform = false;
                for (let platform of platforms) {
                    const platformScreenX = platform.x - groundOffset;
                    if (player.x + player.width > platformScreenX &&
                        player.x < platformScreenX + platform.width &&
                        Math.abs((player.y + player.height) - platform.y) < 20) {
                        onPlatform = true;
                        break;
                    }
                }
                
                // í”Œë«í¼ ìœ„ì— ìˆì§€ ì•Šìœ¼ë©´ ì²« ë²ˆì§¸ ì í”„ ë¶ˆê°€
                if (!onPlatform && player.velocityY !== 0) return;
            }

            // ë‘ ë²ˆì§¸ ì í”„: ê³µì¤‘ì—ì„œ ê°€ëŠ¥
            if (player.jumpCount === 1) {
                // í”Œë«í¼ ìœ„ì— ìˆìœ¼ë©´ ë‘ ë²ˆì§¸ ì í”„ ë¶ˆê°€ (ì´ë¯¸ ì°©ì§€í•œ ìƒíƒœ)
                let onPlatform = false;
                for (let platform of platforms) {
                    const platformScreenX = platform.x - groundOffset;
                    if (player.x + player.width > platformScreenX &&
                        player.x < platformScreenX + platform.width &&
                        Math.abs((player.y + player.height) - platform.y) < 10) {
                        onPlatform = true;
                        break;
                    }
                }
                if (onPlatform) {
                    return; // ì´ë¯¸ í”Œë«í¼ ìœ„ì— ìˆìœ¼ë©´ ë‘ ë²ˆì§¸ ì í”„ ë¶ˆê°€
                }
                // ë‘ ë²ˆì§¸ ì í”„ëŠ” ê³µì¤‘ì—ì„œë§Œ ê°€ëŠ¥ (ìœ„ë¡œ ì˜¬ë¼ê°€ëŠ” ì¤‘ì´ì–´ë„ í—ˆìš©)
                // ìŠ¤í˜ì´ìŠ¤ë°”ë¥¼ ë¹ ë¥´ê²Œ 2ë²ˆ ëˆ„ë¥´ë©´ ì²« ë²ˆì§¸ ì í”„ ì§í›„ ë‘ ë²ˆì§¸ ì í”„ ê°€ëŠ¥
            }

            // ì í”„ ì‹¤í–‰
            player.velocityY = player.jumpPower;
            player.isJumping = true;
            player.jumpCount++;
            
            // ì í”„ íŒŒí‹°í´ íš¨ê³¼ ìƒì„±
            createJumpParticles();
            
            // ì í”„ ì†Œë¦¬ ì¬ìƒ
            playJumpSound();
        }
        
        // ì í”„ íŒŒí‹°í´ ìƒì„±
        function createJumpParticles() {
            const particleX = player.x + player.width / 2;
            const particleY = player.y + player.height;
            
            for (let i = 0; i < 8; i++) {
                particles.push({
                    x: particleX + (Math.random() - 0.5) * 20,
                    y: particleY,
                    vx: (Math.random() - 0.5) * 4,
                    vy: Math.random() * 2 + 1,
                    life: 20,
                    maxLife: 20,
                    size: 2 + Math.random() * 3
                });
            }
        }
        
        // ì í”„ ì†Œë¦¬ ì¬ìƒ
        function playJumpSound() {
            if (!audioContext) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch(e) {
                    return; // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ
                }
            }
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 400;
            oscillator.type = 'square';
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        function startGame() {
            if (gameRunning && !gamePaused) return;

            // ì´ì „ ê²Œì„ ë£¨í”„ê°€ ìˆìœ¼ë©´ ì¤‘ì§€
            stopGameLoop();

            if (!gameRunning) {
                // ìƒˆ ê²Œì„ ì´ˆê¸°í™”
                initializePlatforms();
                player.y = platforms[0].y - player.height; // í”Œë«í¼ ìœ„ì— ì •í™•íˆ ìœ„ì¹˜
                player.groundY = platforms[0].y - player.height;
                player.velocityY = 0;
                player.isJumping = false;
                player.jumpCount = 0;
                gameSpeed = 5;
                distance = 0;
                score = 0;
                groundOffset = 0;
                obstacles = [];
                keysPressed.space = false;
                keysPressed.up = false;
                initializeClouds();
            }

            gameRunning = true;
            gamePaused = false;
            gameStatus.textContent = 'ê²Œì„ ì¤‘...';
            gameStatus.className = 'game-status playing';
            startButton.disabled = true;
            pauseButton.disabled = false;
            
            drawGame();
            gameLoop();
        }

        function pauseGame() {
            if (!gameRunning) return;

            gamePaused = !gamePaused;
            if (gamePaused) {
                gameStatus.textContent = 'ì¼ì‹œì •ì§€ ì¤‘...';
                gameStatus.className = 'game-status';
                pauseButton.textContent = 'ì¬ê°œ';
                // ì¼ì‹œì •ì§€ ì‹œ ê²Œì„ ë£¨í”„ëŠ” ìë™ìœ¼ë¡œ ì¤‘ì§€ë¨ (gameLoop ë‚´ë¶€ ì²´í¬)
            } else {
                gameStatus.textContent = 'ê²Œì„ ì¤‘...';
                gameStatus.className = 'game-status playing';
                pauseButton.textContent = 'ì¼ì‹œì •ì§€';
                // ì¬ê°œ ì‹œ ê²Œì„ ë£¨í”„ ì¬ì‹œì‘
                if (gameLoopId === null) {
                    gameLoop();
                }
            }
        }

        function resetGame() {
            gameRunning = false;
            gamePaused = false;
            stopGameLoop(); // ê²Œì„ ë£¨í”„ ì¤‘ì§€
            initializePlatforms();
            player.y = platforms[0].y - player.height; // í”Œë«í¼ ìœ„ì— ì •í™•íˆ ìœ„ì¹˜
            player.groundY = platforms[0].y - player.height;
            player.velocityY = 0;
            player.isJumping = false;
            player.jumpCount = 0;
            gameSpeed = 5;
            distance = 0;
            score = 0;
            groundOffset = 0;
            obstacles = [];
            keysPressed.space = false;
            keysPressed.up = false;
            distanceDisplay.textContent = '0m';
            scoreDisplay.textContent = '0';
            speedDisplay.textContent = '1.0x';
            jumpCountDisplay.textContent = '2/2';
            gameStatus.textContent = 'ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” í™”ì‚´í‘œ ìœ„ë¥¼ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”!';
            gameStatus.className = 'game-status';
            startButton.disabled = false;
            pauseButton.disabled = true;
            pauseButton.textContent = 'ì¼ì‹œì •ì§€';
            initializeClouds();
            drawGame();
        }

        // í‚¤ë³´ë“œ ì…ë ¥
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.key === 'ArrowUp' || e.key === ' ') {
                e.preventDefault();
                
                const isSpaceOrUp = e.code === 'Space' || e.key === ' ' || e.key === 'ArrowUp';
                
                if (!gameRunning) {
                    startGame();
                } else if (gameRunning && !gamePaused) {
                    // ì—°ì† ì í”„ë¥¼ í—ˆìš©í•˜ê¸° ìœ„í•´ í‚¤ ìƒíƒœ ì²´í¬ ì œê±°
                    // ìŠ¤í˜ì´ìŠ¤ë°”ë¥¼ ë¹ ë¥´ê²Œ 2ë²ˆ ëˆ„ë¥´ë©´ 2ë‹¨ ì í”„ ê°€ëŠ¥
                    jump();
                } else if (gamePaused) {
                    pauseGame();
                }
                
                if (isSpaceOrUp) {
                    keysPressed.space = true;
                }
            }
        });

        // í‚¤ê°€ ë–¼ì–´ì¡Œì„ ë•Œ
        document.addEventListener('keyup', (e) => {
            if (e.code === 'Space' || e.key === 'ArrowUp' || e.key === ' ') {
                e.preventDefault();
                keysPressed.space = false;
            }
        });

        // ì´ˆê¸°í™”
        initializePlatforms();
        initializeClouds();
        drawGame();
    </script>
</body>
</html>
